<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ½ï¸ Äáº·t mÃ³n há»™i tráº¡i</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}

@keyframes gradientShift{
  0%,100%{background-position:0% 50%}
  50%{background-position:100% 50%}
}

@keyframes float{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
}

@keyframes slideIn{
  from{opacity:0;transform:translateY(20px)}
  to{opacity:1;transform:translateY(0)}
}

@keyframes pulse{
  0%,100%{box-shadow:0 0 0 0 rgba(255,87,34,.7)}
  50%{box-shadow:0 0 0 10px rgba(255,87,34,0)}
}

body{
  font-family:'Poppins',-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;
  margin:0;
  padding:0;
  min-height:100vh;
  background:linear-gradient(-45deg,#ff6b6b,#ffa500,#ff6b9d,#c44569,#f8b500);
  background-size:400% 400%;
  animation:gradientShift 15s ease infinite;
  position:relative;
  overflow-x:hidden;
}

body::before{
  content:'';
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:url('data:image/svg+xml,<svg width="100" height="100" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/><circle cx="10" cy="60" r="0.5" fill="rgba(255,255,255,0.1)"/><circle cx="90" cy="40" r="0.5" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
  opacity:0.3;
  pointer-events:none;
  z-index:0;
  -webkit-transform:translateZ(0);
  transform:translateZ(0);
}

.header{
  text-align:center;
  padding:30px 20px 20px;
  color:#fff;
  position:relative;
  z-index:1;
  animation:slideIn 0.6s ease;
}

.header h1{
  margin:0;
  font-size:2.5em;
  font-weight:800;
  text-shadow:2px 2px 10px rgba(0,0,0,.3);
  letter-spacing:1px;
  background:linear-gradient(45deg,#fff,#ffeaa7);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
}

.header p{
  margin:10px 0 0;
  font-size:1.1em;
  opacity:.95;
  font-weight:300;
}

nav{
  background:rgba(255,255,255,.15);
  backdrop-filter:blur(20px);
  -webkit-backdrop-filter:blur(20px);
  padding:15px;
  display:flex;
  justify-content:space-around;
  position:sticky;
  top:0;
  z-index:1000;
  box-shadow:0 8px 32px rgba(0,0,0,.1);
  border-bottom:1px solid rgba(255,255,255,.2);
  pointer-events:auto;
  -webkit-transform:translateZ(0);
  transform:translateZ(0);
}

nav button{
  background:rgba(255,255,255,.2);
  border:2px solid rgba(255,255,255,.3);
  color:#fff;
  font-size:15px;
  font-weight:600;
  padding:12px 24px;
  border-radius:25px;
  cursor:pointer;
  transition:all .3s ease;
  backdrop-filter:blur(10px);
  -webkit-backdrop-filter:blur(10px);
  text-shadow:0 2px 5px rgba(0,0,0,.2);
  position:relative;
  overflow:hidden;
  -webkit-tap-highlight-color:rgba(255,255,255,.3);
  -webkit-touch-callout:none;
  touch-action:manipulation;
  user-select:none;
  -webkit-user-select:none;
  min-height:44px;
  min-width:44px;
  display:flex;
  align-items:center;
  justify-content:center;
}

nav button::before{
  content:'';
  position:absolute;
  top:0;
  left:-100%;
  width:100%;
  height:100%;
  background:linear-gradient(90deg,transparent,rgba(255,255,255,.3),transparent);
  transition:left .5s;
}

nav button:hover::before{
  left:100%;
}

nav button:hover{
  background:rgba(255,255,255,.35);
  transform:translateY(-2px);
  box-shadow:0 5px 20px rgba(0,0,0,.2);
  border-color:rgba(255,255,255,.5);
}

nav button:active{
  transform:translateY(0);
}

.container{
  padding:20px;
  max-width:600px;
  margin:0 auto;
  position:relative;
  z-index:1;
}

.card{
  background:rgba(255,255,255,.95);
  backdrop-filter:blur(20px);
  -webkit-backdrop-filter:blur(20px);
  padding:25px;
  border-radius:20px;
  margin-bottom:20px;
  box-shadow:0 10px 40px rgba(0,0,0,.15),0 0 0 1px rgba(255,255,255,.5);
  animation:slideIn 0.6s ease;
  transition:all .3s ease;
  border:1px solid rgba(255,255,255,.3);
}

.card:hover{
  transform:translateY(-5px);
  box-shadow:0 15px 50px rgba(0,0,0,.2),0 0 0 1px rgba(255,255,255,.6);
}

.card:nth-child(1){animation-delay:0.1s}
.card:nth-child(2){animation-delay:0.2s}
.card:nth-child(3){animation-delay:0.3s}

h2{
  margin:0 0 20px;
  font-size:24px;
  font-weight:700;
  background:linear-gradient(135deg,#ff6b6b,#ffa500);
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
  background-clip:text;
  display:flex;
  align-items:center;
  gap:10px;
}

h2::before{
  content:'âœ¨';
  font-size:1.2em;
  animation:float 3s ease-in-out infinite;
}

label{
  display:block;
  margin-top:15px;
  font-weight:600;
  font-size:15px;
  color:#333;
  margin-bottom:8px;
}

select,input{
  width:100%;
  padding:14px 16px;
  margin-top:4px;
  font-size:15px;
  border-radius:12px;
  border:2px solid #e0e0e0;
  background:#fff;
  transition:all .3s ease;
  font-family:'Poppins',sans-serif;
}

select:focus,input:focus{
  outline:none;
  border-color:#ff6b6b;
  box-shadow:0 0 0 4px rgba(255,107,107,.1);
  transform:translateY(-2px);
}

select:hover,input:hover{
  border-color:#ffa500;
}

button{
  width:100%;
  padding:16px;
  margin-top:18px;
  font-size:16px;
  font-weight:600;
  border:none;
  border-radius:12px;
  background:linear-gradient(135deg,#ff6b6b,#ffa500,#ff6b9d);
  background-size:200% 200%;
  color:#fff;
  cursor:pointer;
  transition:all .3s ease;
  box-shadow:0 6px 20px rgba(255,107,107,.4);
  text-transform:uppercase;
  letter-spacing:1px;
  position:relative;
  overflow:hidden;
  -webkit-tap-highlight-color:rgba(255,255,255,.3);
  -webkit-touch-callout:none;
  touch-action:manipulation;
  user-select:none;
  -webkit-user-select:none;
  min-height:44px;
}

button::before{
  content:'';
  position:absolute;
  top:50%;
  left:50%;
  width:0;
  height:0;
  border-radius:50%;
  background:rgba(255,255,255,.3);
  transform:translate(-50%,-50%);
  transition:width .6s,height .6s;
}

button:hover::before{
  width:300px;
  height:300px;
}

button:hover{
  background-position:100% 0;
  transform:translateY(-3px);
  box-shadow:0 10px 30px rgba(255,107,107,.6);
  animation:pulse 2s infinite;
}

button:active{
  transform:translateY(-1px);
}

.hidden{display:none;opacity:0;transition:opacity .3s ease}
.card{opacity:1;transition:opacity .3s ease}

.qty{
  display:flex;
  gap:15px;
  justify-content:center;
  align-items:center;
  margin-top:15px;
}

.qty input{
  width:80px;
  text-align:center;
  font-weight:700;
  font-size:18px;
  margin:0;
}

.qty button{
  width:45px;
  height:45px;
  border-radius:50%;
  padding:0;
  margin:0;
  font-size:20px;
  font-weight:700;
  background:linear-gradient(135deg,#667eea,#764ba2);
  box-shadow:0 4px 15px rgba(102,126,234,.4);
  display:flex;
  align-items:center;
  justify-content:center;
}

.qty button:hover{
  background:linear-gradient(135deg,#764ba2,#667eea);
  transform:scale(1.1);
}

table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  margin-top:15px;
  font-size:14px;
  border-radius:12px;
  overflow:hidden;
  box-shadow:0 4px 15px rgba(0,0,0,.1);
}

th,td{
  padding:15px;
  text-align:left;
}

th{
  background:linear-gradient(135deg,#667eea,#764ba2);
  color:#fff;
  font-weight:600;
  text-transform:uppercase;
  font-size:12px;
  letter-spacing:1px;
}

tr:nth-child(even){
  background:#f8f9fa;
}

tr:hover{
  background:#fff3e0;
  transform:scale(1.02);
  transition:all .2s ease;
}

td button{
  width:auto;
  padding:8px 16px;
  margin:0;
  font-size:13px;
  background:linear-gradient(135deg,#ff6b6b,#ff4757);
  box-shadow:0 3px 10px rgba(255,71,87,.3);
}

td button:hover{
  transform:scale(1.05);
}

.badge{
  display:inline-block;
  background:linear-gradient(135deg,#ffeaa7,#fdcb6e);
  padding:6px 12px;
  border-radius:20px;
  font-size:12px;
  font-weight:600;
  color:#333;
  margin:4px 4px 4px 0;
  box-shadow:0 2px 8px rgba(253,203,110,.3);
}

@media (max-width:600px){
  .header h1{font-size:2em}
  nav{flex-direction:column;gap:10px}
  nav button{width:100%}
  .container{padding:15px}
}
</style>
</head>

<body>

<div class="header">
<h1>ğŸ½ï¸ Äáº·t MÃ³n Há»™i Tráº¡i</h1>
<p>Chá»n mÃ³n yÃªu thÃ­ch cá»§a báº¡n ngay hÃ´m nay!</p>
</div>

<nav>
<button onclick="showSection('single')">ğŸ´ MÃ³n láº»</button>
<button onclick="showSection('combo')">ğŸ Combo</button>
<button onclick="showSection('cart')">ğŸ›’ Giá» hÃ ng</button>
</nav>

<div class="container">

<div class="card">
<h2>ğŸ‘¤ ThÃ´ng tin nháº­n hÃ ng</h2>
<label>Cháº³ng hay cao danh quÃ½ tÃ¡nh cá»§a báº±ng há»¯u Ä‘Ã¢y lÃ  chi?*</label><input id="customerName" placeholder="">
<label>ğŸ« Phá»§ Ä‘á»‡ cá»§a vá»‹ báº±ng há»¯u Ä‘Ã¢y tá»a láº¡c nÆ¡i nÃ o *</label><input id="classAddress" placeholder="">
<label>ğŸ“± "Báº±ng há»¯u cÃ³ sá»­ dá»¥ng 'PhiÃªn Báº£n Thá»§ ChÆ°á»Ÿng' thÃ¬ xin hÃ£y Ä‘á»ƒ láº¡i má»™t Ä‘Æ°á»ng dáº«n Ä‘á»ƒ tiá»‡n bá» liÃªn láº¡c *</label><input id="campName" placeholder="Link Facebook">
<label>â° Vá»‹ báº±ng há»¯u Ä‘Ã¢y Ä‘á»‹nh giá» lÃ nh nÃ o thÃ¬ chÃºng ta tÆ°Æ¡ng phÃ¹ng*</label>
<select id="pickupTime">
<option value="">--Chuyá»‡n nÃ y há»‡ trá»ng, xin chá»› quyáº¿t Ä‘á»‹nh khinh suáº¥t!--</option>
<option>8:00 â€“ 9:00</option>
<option>9:00 â€“ 10:00</option>
<option>10:00 â€“ 11:00</option>
</select>
<button onclick="saveCustomer()">ğŸ’¾ LÆ°u thÃ´ng tin</button>
</div>

<div id="single" class="card">    
<h2>ğŸ´ MÃ³n láº»</h2>
<select id="singleItem" onchange="drinkOpt.classList.toggle('hidden',!this.value.includes('TrÃ  chanh dÃ¢y'))">
<option disabled selected>ğŸ½ï¸ Vui lÃ²ng chá»n mÃ³n</option>
<option>ğŸ— GÃ </option>
<option>ğŸ® Pudding trá»©ng</option>
<option>ğŸŒ¿ Pudding há»“ng trÃ </option>
<option>ğŸ¥£ TÃ u hÅ© Singapore</option>
<option>ğŸ¥¤ TrÃ  chanh dÃ¢y</option>
</select>

<div id="drinkOpt" class="hidden">
<label>ğŸ§Š ÄÃ¡</label><select id="singleIce"><option>ÄÃ¡ bÃ¬nh thÆ°á»ng</option><option>Ãt Ä‘Ã¡</option><option>KhÃ´ng Ä‘Ã¡</option></select>
<label>ğŸ® Tháº¡ch</label><select id="singleJelly"><option>Tháº¡ch bÃ¬nh thÆ°á»ng</option><option>KhÃ´ng tháº¡ch</option></select>
</div>

<div class="qty">
<button onclick="changeQty('singleQty',-1)">â–</button>
<input id="singleQty" value="1" type="number" min="1">
<button onclick="changeQty('singleQty',1)">â•</button>
</div>

<button onclick="addSingle()">â• ThÃªm vÃ o giá»</button>
</div>

<div id="combo" class="card hidden">
<h2>ğŸ Combo</h2>
<select id="comboType" onchange="renderCombo()">
<option disabled selected>ğŸ Vui lÃ²ng chá»n combo</option>
<option>ğŸ Combo 1 gÃ  1 nÆ°á»›c</option>
<option>ğŸ Combo 2 trÃ¡ng miá»‡ng</option>
<option>ğŸ Combo gÃ¬ cÅ©ng cÃ³</option>
</select>
<div id="comboOpt"></div>

<div class="qty">
<button onclick="changeQty('comboQty',-1)">â–</button>
<input id="comboQty" value="1" type="number" min="1">
<button onclick="changeQty('comboQty',1)">â•</button>
</div>

<button onclick="addCombo()">â• ThÃªm combo vÃ o giá»</button>
</div>

<div id="cart" class="card hidden">
<h2>ğŸ›’ Giá» hÃ ng</h2>
<table>
<thead><tr><th>Loáº¡i</th><th>Chi tiáº¿t</th><th>SL</th><th>Thao tÃ¡c</th></tr></thead>
<tbody id="cartTable"></tbody>
</table>
<label>ğŸ“ Ghi chÃº cho Ä‘Æ¡n hÃ ng</label>
<textarea id="orderNote"
  placeholder="VÃ­ dá»¥: Ã­t cay, giao sá»›m giÃºp em, gá»i trÆ°á»›c khi tá»›i..."
  style="
    width:100%;
    min-height:100px;
    padding:14px 16px;
    border-radius:12px;
    border:2px solid #e0e0e0;
    font-family:'Poppins',sans-serif;
    font-size:14px;
    resize:vertical;
  "></textarea>
<button onclick="submitCart()">âœ… XÃ¡c nháº­n Ä‘áº·t hÃ ng</button>
</div>

</div>

<script>
const SHEET_URL='https://script.google.com/macros/s/AKfycbzDmg-a9qNMOGvK6eBbKwj2KjuldFv-H4L7euiV3YSUnmpAg0DtWfxzSnD1mx0YWGNHrg/exec';
let cart=[];

window.addEventListener('DOMContentLoaded',()=>{
const saved=localStorage.getItem('customer');
if(saved){
const c=JSON.parse(saved);
customerName.value=c.ten||'';
classAddress.value=c.lop||'';
campName.value=c.trai||'';
pickupTime.value=c.gio||'';
}

const navButtons=document.querySelectorAll('nav button');
navButtons.forEach(btn=>{
const onclickAttr=btn.getAttribute('onclick');
const sectionId=onclickAttr?.match(/'([^']+)'/)?.[1];
if(sectionId){
let touchHandled=false;
btn.addEventListener('touchstart',function(e){
touchHandled=false;
this.style.opacity='0.7';
},{passive:true});
btn.addEventListener('touchend',function(e){
this.style.opacity='1';
if(!touchHandled){
touchHandled=true;
e.preventDefault();
showSection(sectionId);
}
},{passive:false});
btn.addEventListener('touchcancel',function(e){
this.style.opacity='1';
touchHandled=false;
});
btn.onclick=function(e){
if(!touchHandled){
showSection(sectionId);
}
};
}
});
});

function showSection(id){
if(!id) return;
const sections=['single','combo','cart'];
sections.forEach(s=>{
const el=document.getElementById(s);
if(el){
if(!el.classList.contains('hidden')){
el.style.opacity='0';
setTimeout(()=>{
el.classList.add('hidden');
el.style.pointerEvents='none';
},150);
}else{
el.style.pointerEvents='none';
}
}
});
setTimeout(()=>{
const target=document.getElementById(id);
if(target){
target.classList.remove('hidden');
target.style.opacity='0';
target.style.pointerEvents='auto';
setTimeout(()=>{
target.style.opacity='1';
if(id==='cart') renderCart();
},10);
}
},150);
}

function saveCustomer(){
if(!customerName.value||!classAddress.value||!campName.value||!pickupTime.value){
alert('âš ï¸ Vui lÃ²ng Ä‘iá»n Ä‘áº§y Ä‘á»§ thÃ´ng tin!');
return;
}
localStorage.setItem('customer',JSON.stringify({
ten:customerName.value,
lop:classAddress.value,
trai:campName.value,
gio:pickupTime.value
}));
alert('âœ… ÄÃ£ lÆ°u thÃ´ng tin thÃ nh cÃ´ng!');
}

function changeQty(id,d){
const i=document.getElementById(id);
i.value=Math.max(1,Number(i.value)+d);
}
function renderCombo(){
  comboOpt.innerHTML = '';
  const type = comboType.value;

  // ===== COMBO 1: CÃ“ ÄÃ + THáº CH =====
  if(type === 'ğŸ Combo 1 gÃ  1 nÆ°á»›c'){
    comboOpt.innerHTML = `
      <label>ğŸ§Š ÄÃ¡</label>
      <select id="cIce">
        <option>ÄÃ¡ bÃ¬nh thÆ°á»ng</option>
        <option>Ãt Ä‘Ã¡</option>
        <option>KhÃ´ng Ä‘Ã¡</option>
      </select>

      <label>ğŸ® Tháº¡ch</label>
      <select id="cJelly">
        <option>Tháº¡ch bÃ¬nh thÆ°á»ng</option>
        <option>KhÃ´ng tháº¡ch</option>
      </select>
    `;
    return;
  }

  // ===== COMBO 2: 2 TRÃNG MIá»†NG =====
  if(type === 'ğŸ Combo 2 trÃ¡ng miá»‡ng'){
    comboOpt.innerHTML = `
      <label>ğŸ® TrÃ¡ng miá»‡ng 1</label>
      <select id="d1">
        <option>Pudding trá»©ng</option>
        <option>Pudding há»“ng trÃ </option>
        <option>TÃ u hÅ© Singapore</option>
      </select>

      <label>ğŸ® TrÃ¡ng miá»‡ng 2</label>
      <select id="d2">
        <option>Pudding trá»©ng</option>
        <option>Pudding há»“ng trÃ </option>
        <option>TÃ u hÅ© Singapore</option>
      </select>
    `;
    return;
  }

  // ===== COMBO 3: ÄÃ + THáº CH + 1 TRÃNG MIá»†NG =====
  if(type === 'ğŸ Combo gÃ¬ cÅ©ng cÃ³'){
    comboOpt.innerHTML = `
      <label>ğŸ§Š ÄÃ¡</label>
      <select id="cIce">
        <option>ÄÃ¡ bÃ¬nh thÆ°á»ng</option>
        <option>Ãt Ä‘Ã¡</option>
        <option>KhÃ´ng Ä‘Ã¡</option>
      </select>

      <label>ğŸ® Tháº¡ch</label>
      <select id="cJelly">
        <option>Tháº¡ch bÃ¬nh thÆ°á»ng</option>
        <option>KhÃ´ng tháº¡ch</option>
      </select>

      <label>ğŸ® TrÃ¡ng miá»‡ng</label>
      <select id="d1">
        <option>Pudding trá»©ng</option>
        <option>Pudding há»“ng trÃ </option>
        <option>TÃ u hÅ© Singapore</option>
      </select>
    `;
  }
}
function addSingle(){
  if(!singleItem.value || singleItem.value.includes('Vui lÃ²ng')){
    alert('âš ï¸ Vui lÃ²ng chá»n mÃ³n!');
    return;
  }

  const item = {
    loai: 'MÃ³n láº»',
    noiDung: singleItem.value,
    soLuong: Number(singleQty.value),
    chiTiet: {}
  };

  // ğŸ¥¤ TRÃ€ CHANH DÃ‚Y â€“ CÃ“ SIZE, ÄÃ, THáº CH
  if(singleItem.value === 'ğŸ¥¤ TrÃ  chanh dÃ¢y'){
    item.chiTiet = {       
      da: singleIce.value,          // ÄÃ¡ / Ãt Ä‘Ã¡ / KhÃ´ng Ä‘Ã¡
      thach: singleJelly.value      // CÃ³ / KhÃ´ng tháº¡ch
    };
  }

  cart.push(item);

  alert('âœ… ÄÃ£ thÃªm vÃ o giá» hÃ ng!');
  singleItem.value = '';
  singleQty.value = 1;
  drinkOpt.classList.add('hidden');
}
function addCombo(){
  if(!comboType.value || comboType.value.includes('Vui lÃ²ng')){
    alert('âš ï¸ Vui lÃ²ng chá»n combo!');
    return;
  }

  let chiTiet = {};

  // ===== COMBO 1: gÃ  + nÆ°á»›c (Báº®T BUá»˜C CÃ“ ÄÃ + THáº CH) =====
  if(comboType.value === 'ğŸ Combo 1 gÃ  1 nÆ°á»›c'){
    chiTiet = {
      da: cIce.value,
      thach: cJelly.value
    };
  }

  // ===== COMBO 2: 2 TRÃNG MIá»†NG =====
  else if(comboType.value === 'ğŸ Combo 2 trÃ¡ng miá»‡ng'){
    chiTiet = {
      trangmieng: [d1.value, d2.value]
    };
  }

  // ===== COMBO 3: GÃŒ CÅ¨NG CÃ“ =====
  else if(comboType.value === 'ğŸ Combo gÃ¬ cÅ©ng cÃ³'){
    chiTiet = {
      da: cIce.value,
      thach: cJelly.value,
      trangmieng: [d1.value]
    };
  }

  cart.push({
    loai: 'Combo',
    noiDung: comboType.value,
    chiTiet: chiTiet,
    soLuong: Number(comboQty.value)
  });

  alert('âœ… ÄÃ£ thÃªm combo vÃ o giá» hÃ ng!');
  comboType.value='';
  comboQty.value=1;
  comboOpt.innerHTML='';
}
const desserts=[d1.value];
if(window.d2) desserts.push(d2.value);
cart.push({
loai:'Combo',
noiDung:comboType.value,
chiTiet:{
trangmieng:desserts,
da:window.cIce?.value||'',
thach:window.cJelly?.value||''
},
soLuong:comboQty.value
});
alert('âœ… ÄÃ£ thÃªm combo vÃ o giá» hÃ ng!');
comboType.value='';
comboQty.value=1;
comboOpt.innerHTML='';


function renderCart(){
cartTable.innerHTML='';
if(cart.length===0){
cartTable.innerHTML=`<tr><td colspan="4" style="text-align:center;padding:30px;color:#999;">ğŸ›’ Giá» hÃ ng trá»‘ng</td></tr>`;
return;
}
cart.forEach((c,i)=>{
const icon=c.loai==='Combo'?'ğŸ':'ğŸ´';
cartTable.innerHTML+=`
<tr>
<td><strong>${icon} ${c.loai}</strong></td>
<td>
<b>${c.noiDung}</b><br>
${c.chiTiet?.size?`<span class="badge">ğŸ“ ${c.chiTiet.size}</span><br>`:''}
${c.chiTiet?.trangmieng?`<span class="badge">ğŸ® TrÃ¡ng miá»‡ng: ${c.chiTiet.trangmieng.join(', ')}</span><br>`:''}
${c.chiTiet?.da?`<span class="badge">ğŸ¥¤ NÆ°á»›c: ${c.chiTiet.da}, ${c.chiTiet.thach}</span>`:''}
</td>
<td><strong style="font-size:18px;">${c.soLuong}</strong></td>
<td><button onclick="cart.splice(${i},1);renderCart()">ğŸ—‘ï¸ XÃ³a</button></td>
</tr>`;
});
}

async function submitCart(){
if(cart.length===0){
alert('âš ï¸ Giá» hÃ ng trá»‘ng! Vui lÃ²ng thÃªm mÃ³n trÆ°á»›c khi Ä‘áº·t hÃ ng.');
return;
}
const customer=JSON.parse(localStorage.getItem('customer'));
if(!customer||!customer.ten){
alert('âš ï¸ Vui lÃ²ng Ä‘iá»n thÃ´ng tin nháº­n hÃ ng trÆ°á»›c!');
showSection('single');
document.querySelector('.card').scrollIntoView({behavior:'smooth'});
return;
}
if(!confirm(`âœ… XÃ¡c nháº­n Ä‘áº·t ${cart.length} mÃ³n?\n\nTÃªn: ${customer.ten}\nLá»›p: ${customer.lop}\nKhung giá»: ${customer.gio}`)){
return;
}
const btn=event.target;
btn.disabled=true;
btn.textContent='â³ Äang gá»­i...';

const data={
customer:customer,
cart:cart,
note: document.getElementById('orderNote').value || '',
timestamp:new Date().toISOString()
};

try{
const formData=new URLSearchParams();
formData.append('data',JSON.stringify(data));

const response=await fetch(SHEET_URL,{
method:'POST',
mode:'no-cors',
headers:{
'Content-Type':'application/x-www-form-urlencoded',
},
body:formData.toString()
});

setTimeout(()=>{
localStorage.clear();
cart=[];
location.href='thankyou.html';
},800);
}catch(error){
console.error('Submit error:',error);
try{
const response2=await fetch(SHEET_URL+'?data='+encodeURIComponent(JSON.stringify(data)),{
method:'GET',
mode:'no-cors'
});
setTimeout(()=>{
localStorage.clear();
cart=[];
location.href='thankyou.html';
},800);
}catch(error2){
console.error('Fallback error:',error2);
alert('âš ï¸ ÄÃ£ gá»­i Ä‘Æ¡n hÃ ng!\n\nLÆ°u Ã½: Náº¿u khÃ´ng tháº¥y dá»¯ liá»‡u trong Google Sheet, vui lÃ²ng kiá»ƒm tra:\n1. URL Google Apps Script\n2. Quyá»n truy cáº­p cá»§a script\n3. Format dá»¯ liá»‡u trong script\n\nÄÆ¡n hÃ ng Ä‘Ã£ Ä‘Æ°á»£c lÆ°u táº¡m.');
setTimeout(()=>{
localStorage.clear();
cart=[];
location.href='thankyou.html';
},2000);
}
}
}
</script>

</body>
</html>
